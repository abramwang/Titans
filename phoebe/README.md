# 华鑫证券业绩数据管理系统

## 📊 项目概述

这是一个用于分析华鑫证券业绩数据的完整管理系统，支持Excel数据导入、MySQL数据库存储、多维度业务分析和数据验证。

## 🏗️ 系统架构

### 核心模块

1. **主程序** (`main.py`)
   - 系统入口和菜单管理
   - 统一的用户界面

2. **数据导入** (`enhanced_importer.py`)
   - 基于4个业务部分的智能数据导入
   - 支持处理空行和不连续数据
   - 正确的盈利计算逻辑

3. **业务分析** (`enhanced_business_analysis.py`)
   - 多维度业务分析报告
   - 风险收益分析
   - 时间序列分析

4. **数据验证** (`data_validation_comparator.py`)
   - Excel统计文件对比验证
   - 数据完整性检查
   - 差异分析报告

5. **配置管理** (`config.py`)
   - 数据库连接配置
   - 系统参数设置

## 📈 业务部分分类

系统识别并处理4个核心业务部分：

1. **日内底仓T0** (TRADING)
   - 日内交易数据
   - T+0 交易记录

2. **ETF日内申赎** (TRADING)
   - ETF申购赎回交易
   - 日内ETF操作

3. **隔夜底仓** (POSITION)
   - 隔夜持仓数据
   - 持仓盈亏计算

4. **ETF赎回涨停票** (POSITION)
   - 特殊ETF赎回操作
   - 涨停票处理

## 🗄️ 数据库设计

### 核心数据表

- `account_info` - 账户基本信息
- `securities` - 证券基础信息
- `daily_trading_details` - 日度交易明细
- `daily_account_assets` - 日度账户资产
- `profit_loss_summary` - 盈亏汇总
- `import_log` - 数据导入日志

## 🚀 快速开始

### 1. 环境准备

```bash
# 激活Python虚拟环境
source env/bin/activate

# 安装依赖包（如需要）
pip install pandas openpyxl sqlalchemy pymysql
```

### 2. 数据库配置

确保MySQL数据库已创建，并在 `config.py` 中配置正确的连接信息。

### 3. 运行系统

```bash
python main.py
```

### 4. 功能菜单

- **选项1**: 基于4个业务部分的数据导入
- **选项2**: 基于业务部分的分析报告  
- **选项3**: 数据验证对比分析
- **选项4**: 验证数据质量

## 📁 数据文件要求

### Excel文件格式

系统支持处理以下格式的Excel文件：

- 文件名格式：`华鑫_314000045768_业绩估算_YYYY-MM-DD.xlsx`
- 包含4个业务部分的标准化数据结构
- 支持空行和不连续数据处理

### 统计文件

- 统计汇总文件：`华鑫_314000045768_业绩统计.xlsx`
- 用于数据验证和对比分析

## ⚙️ 系统特性

### 数据处理能力

- ✅ 智能识别4个业务部分
- ✅ 处理空行和不连续数据
- ✅ 正确计算持仓盈亏
- ✅ 自动数据验证

### 分析功能

- ✅ 多维度业务分析
- ✅ 证券表现排名
- ✅ 时间序列趋势
- ✅ 风险收益指标
- ✅ 业务洞察建议

### 数据质量保证

- ✅ 导入完整性检查
- ✅ 与Excel统计对比验证
- ✅ 异常数据识别
- ✅ 详细日志记录

## 🔧 技术栈

- **Python 3.12+**
- **pandas** - 数据处理
- **openpyxl** - Excel文件读取
- **SQLAlchemy** - 数据库ORM
- **PyMySQL** - MySQL连接器
- **MySQL** - 数据存储

## 📊 输出报告

系统生成多种分析报告：

1. **业务部分分析报告** - 各业务部分盈利概览
2. **证券表现分析** - 最佳表现证券排名
3. **时间序列分析** - 日度和周度趋势
4. **风险收益分析** - 胜率和夏普比率
5. **数据验证报告** - 完整性和准确性验证

## 🛠️ 维护说明

### 日常操作

1. 定期导入新的Excel数据文件
2. 运行数据验证确保准确性
3. 生成定期分析报告
4. 监控系统运行日志

### 故障排除

- 检查数据库连接状态
- 验证Excel文件格式
- 查看导入日志错误信息
- 确认数据完整性

## 📝 版本历史

- **v1.0** - 基础数据导入和分析功能
- **v2.0** - 增强4个业务部分识别
- **v3.0** - 修复数据遗漏问题，优化盈利计算
- **v3.1** - 项目清理，保留核心功能

## 👥 支持

如有问题或建议，请联系开发团队。
